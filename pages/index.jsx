import { useState } from "react";
import Head from "next/head";
import About from "../components/About";
import Contact from "../components/Contact";
import Header from "../components/Header";
import Hero from "../components/Hero";
import Skills from "../components/Skills";
import Projects from "./../components/Projects";
import { sanityClient } from "../lib/sanity.server";

const projectQuery = `
   *[_type == "project"]{
    name,
    projectTech,
    projectInfo,
    gitHub,
    liveLink,
    projectImage {
    asset {
    _ref
  }
  }
  }
  `;

const pageInfoQuery = `
*[_type == "pageInfo"][0]{
  profileName,
  role,
  profilePic{
asset {
  _ref
} },
  phoneNumber,
  email,
  resume {
    asset-> {url}
  },
  Info,
  address,
  socials,
  heroImage{
asset {
  _ref
}
}
}

`;

export default function Home({ project, pageInfo }) {
  const [navToggle, setNavToggle] = useState(true);

  const handleNav = () => {
    setNavToggle((navToggle) => !navToggle);
    console.log(navToggle);
  };

  return (
    <div className=" h-screen overflow-scroll overflow-x-hidden scrollbar scrollbar-thumb-[#3CA7CB] scrollbar-track-gray-700 snap-y">
      <Head>
        <title>Leyecodes Portfolio</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      {/* Header */}
      <Header handleNav={handleNav} navToggle={navToggle} pageInfo={pageInfo} />
      {/* Main */}
      <main className="max-w-7xl mx-auto ">
        {/* Hero */}
        <section id="hero" className="snap-center">
          <Hero />
        </section>
        {/* About */}
        <section id="about" className="snap-center">
          <About pageInfo={pageInfo} />
        </section>
        {/* Skills */}
        <section id="skills" className="snap-center">
          <Skills />
        </section>
        {/* Projects */}
        <section id="projects" className="snap-center">
          <Projects projects={project} />
        </section>
        {/* Contact */}
        <section id="contact" className="snap-center">
          <Contact pageInfo={pageInfo} />
        </section>
      </main>
    </div>
  );
}

export async function getStaticProps() {
  const project = await sanityClient.fetch(projectQuery);

  const pageInfo = await sanityClient.fetch(pageInfoQuery);
  return {
    props: { project, pageInfo },
  };
}
